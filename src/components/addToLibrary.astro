---
import { Button } from "@/components/ui/button"
import { getSession } from "auth-astro/server"

const session = await getSession(Astro.request)
---

<Button client:load id="boton" className="ml-5" variant={"default"}>
	AÃ±adir a la tu biblioteca</Button
>

<script>
	const boton = document.getElementById("boton")
	boton?.addEventListener("click", async () => {
		const response = await fetch("/api/agregar", {
			method: "POST",
			headers: {
				"Content-Type": "application/json",
			},
		})
		if (response.ok) {
			alert("Agregado a tu biblioteca")
		} else {
			alert("Error al agregar a tu biblioteca")
		}
	})
</script>
